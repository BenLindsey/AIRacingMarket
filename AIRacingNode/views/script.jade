include ./basic_navigator.jade

block content
    h1.
        Create your Racing Script

        form#newScriptForm.form-horizontal(method='post')
            fieldset
                .row
                  div.well.bs-component
                    .col-lg-7
                      .form-group
                        label.col-lg-2.control-label(for='inputScriptName') Script Name
                        .col-lg-8
                    input#inputScriptName.form-control(placeholder='Enter a Script Name', type='text', name="scriptname")
                      .form-group
                        label.col-lg-2.control-label(for='inputScript') Script
                        .col-lg-8
                    textarea#inputScript(name='script', data-editor="javascript",  rows="20") 
                      .form-group
                        .col-lg-6.col-lg-offset-2
                    .btn-group
                      button.btn.btn-default(type='reset') Reset
                      button.btn.btn-primary(type='submit') Submit
                if notLoggedIn
                  div.well.bs-component
                    .col-lg-4
                      h2.
                        Optional Details :
                      br
                      .form-group
                          label.col-lg-2.control-label(for='inputEmailAddress') Email Address
                          .col-lg-8
                        input#inputEmailAddress.form-control(placeholder='Enter your Email Address', type='email', name="emailaddress")
                      .form-group
                          label.col-lg-2.control-label(for='inputUniversityName') University Name
                          .col-lg-8
                        input#inputUniversityName.form-control(placeholder='Which University do you attend?', type='text', name="university")
                      .form-group
                          label.col-lg-2.control-label(for='inputCourse') Course
                          .col-lg-8
                        input#inputCourse.form-control(placeholder='What do you study?', type='text', name="course")
                      .form-group
                          label.col-lg-2.control-label(for='inputYearGroup') Year Group
                          .col-lg-8
                        select#inputYearGroup.form-control
                            option 1st Year
                            option 2nd Year
                            option 3rd Year
                            option 4th Year

    script(src="http://ajaxorg.github.io/ace-builds/src/ace.js")
    script(type='text/javascript').
      $(document).ready(function () {
        $('textarea[data-editor]').each(function () {

          var textarea = $(this);
          var mode = textarea.data('editor');

          var editDiv = $('<div>', {
            position:'absolute',
            width:textarea.parent().width(),
            height:textarea.height(),
            'class':textarea.attr('class')
          }).insertBefore(textarea);

          textarea.css('display', 'none');

          var editor = ace.edit(editDiv[0]);

          editor.getSession().on('change', function(){
            textarea.val(editor.getSession().getValue());
          });

          editor.getSession().setValue(!{JSON.stringify(script)});
          editor.getSession().setMode("ace/mode/" + mode);
          editor.renderer.setShowGutter(true);
          editor.setFontSize("16px");
          editor.setTheme("ace/theme/solarized_light");
          editor.setEnableBasicAutocompletion(true);
        });
      });
